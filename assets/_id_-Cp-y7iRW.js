import{u as k,a as q,P as w,h as x,a0 as I,$,f as P,w as r,bD as B,o as F,d as e,am as l,T as u,ad as N,at as Q,e as n,an as R,R as T,S as D,bh as M}from"./index-BJ5mKrdB.js";import{c as U,d as A,u as E,e as O}from"./index.esm-C7K4et6N.js";import{b as y}from"./route-block-B_A1xBdJ.js";import{V as j}from"./VContainer-D9u67iRf.js";import{V as L}from"./VRow-C-TIxZZV.js";import{V as p}from"./VCol-BTinVxch.js";import{V as z}from"./VDivider-CdbKQ_Fw.js";import{V as G}from"./VForm-CqVZ6SJA.js";const H={class:"text-center"},J={class:"text-center"},K={__name:"[id]",setup(W){const{api:V,apiAuth:b}=$(),_=B(),m=I(),{t:s}=k(),f=q(),g=w(),t=x({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:"food"});(async()=>{try{const{data:a}=await V.get("/product/"+_.params.id);t.value=a.result,document.title=t.value.name+" | Taste of Us"}catch(a){console.log(a),m.push("/")}})();const h=U({quantity:A().typeError(s("product.addCartQuantityInvalid")).required(s("product.addCartQuantityInvalid")).positive(s("product.addCartQuantityInvalid")).integer(s("product.addCartQuantityInvalid"))}),{handleSubmit:S,isSubmitting:v}=E({validationSchema:h,initialValues:{quantity:1}}),c=O("quantity"),C=S(async a=>{var i,d;if(!f.isLoggedIn){m.push("/login");return}try{const{data:o}=await b.patch("/user/cart",{product:t.value._id,quantity:a.quantity});f.cart=o.result,g({text:s("product.addCartSuccess"),snackbarProps:{color:"green"}})}catch(o){console.log(o),g({text:s("api."+(((d=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:d.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(a,i)=>(F(),P(j,null,{default:r(()=>[e(L,null,{default:r(()=>[e(p,{cols:"12"},{default:r(()=>[l("h1",H,u(t.value.name),1)]),_:1}),e(z),e(p,{cols:"12",md:"6"},{default:r(()=>[e(N,{src:t.value.image},null,8,["src"])]),_:1}),e(p,{cols:"12",md:"6"},{default:r(()=>[l("p",null,u(a.$t("productCategory."+t.value.category)),1),l("p",null,u(t.value.price),1),l("p",null,u(t.value.description),1),e(G,{disabled:n(v),onSubmit:Q(n(C),["prevent"])},{default:r(()=>[e(R,{modelValue:n(c).value.value,"onUpdate:modelValue":i[0]||(i[0]=d=>n(c).value.value=d),modelModifiers:{number:!0},type:"number","error-messages":n(c).errorMessage.value},null,8,["modelValue","error-messages"]),e(T,{type:"submit","prepend-icon":"mdi-cart",loading:n(v)},{default:r(()=>[D(u(a.$t("product.addCart")),1)]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}),e(M,{"model-value":!t.value.sell,class:"align-center justify-center",scrim:"black",opacity:"0.8",persistent:""},{default:r(()=>[l("h1",J,u(a.$t("api.productNotOnSell")),1)]),_:1},8,["model-value"])]),_:1}))}};typeof y=="function"&&y(K);export{K as default};
