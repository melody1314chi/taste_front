import{u as y,W as A,a as T,a4 as $,a5 as P,g as q,w as l,o as B,d as o,S as m,T as p,ax as F,e as s,ar as g,Z as R,_ as C}from"./index-CdXrf5kD.js";import{c as M,b as f,u as N,e as V}from"./index.esm-CGHwd_I-.js";import{v as U}from"./index-Pd7GBtbP.js";import{b}from"./route-block-B_A1xBdJ.js";import{V as D}from"./VContainer-CBe7NjUn.js";import{V as I}from"./VRow-Dxr6VA6r.js";import{V as h}from"./VCol-BRjPifxR.js";import{V as L}from"./VDivider-DPAZxzmH.js";import{V as j}from"./VForm-XDcUWyEx.js";const E={class:"text-center"},W={class:"text-center"},Z={__name:"login",setup(z){const{t:a}=y(),{api:v}=$(),c=A(),w=P(),x=T(),S=M({account:f().required(a("api.userAccountRequired")).min(4,a("api.userAccountTooShort")).max(20,a("api.userAccountTooLong")).test("isAlphanumeric",a("api.userAccountInvalid"),e=>U.isAlphanumeric(e)),password:f().required(a("api.userPasswordRequired")).min(4,a("api.userPasswordTooShort")).max(20,a("api.userPasswordTooLong"))}),{handleSubmit:_,isSubmitting:d}=N({validationSchema:S}),u=V("account"),i=V("password"),k=_(async e=>{var r,t;try{const{data:n}=await v.post("/user/login",{account:e.account,password:e.password});x.login(n.result),c({text:a("login.success"),snackbarProps:{color:"green"}}),w.push("/")}catch(n){console.log(e,"https://taste-back.onrender.com"),console.log(n),c({text:a("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(e,r)=>(B(),q(D,null,{default:l(()=>[o(I,{justify:"center"},{default:l(()=>[o(h,{cols:"4"},{default:l(()=>[m("h1",E,p(e.$t("nav.login")),1)]),_:1}),o(L),o(h,{cols:"4"},{default:l(()=>[o(j,{disabled:s(d),onSubmit:F(s(k),["prevent"])},{default:l(()=>[o(g,{modelValue:s(u).value.value,"onUpdate:modelValue":r[0]||(r[0]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value,label:e.$t("user.account"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),o(g,{modelValue:s(i).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>s(i).value.value=t),type:"password","error-messages":s(i).errorMessage.value,label:e.$t("user.password"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),m("div",W,[o(R,{loading:s(d),type:"submit",color:"primary"},{default:l(()=>[C(p(e.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof b=="function"&&b(Z);export{Z as default};
