import{ao as B,aa as N,c as M,ap as F,h as f,j as O,s as R,k as T,aq as W,g as h,o as d,w as s,d as i,S as j,b as D,R as S,ar as E,F as P,r as $,as as G,ai as q,a3 as L,_ as b,T as I,at as U,au as z}from"./index-DpGVHu_m.js";import{V as H}from"./VRow-z9MLI__U.js";import{V}from"./VCol-CkO_qeVS.js";import{V as J}from"./VContainer-BkSpNhML.js";function K(e){return B()?(N(e),!0):!1}const Q=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const X=e=>e!=null,w=()=>{};function Y(e){return Array.isArray(e)?e:[e]}const Z=Q?window:void 0;function y(e){var t;const n=F(e);return(t=n==null?void 0:n.$el)!=null?t:n}function ee(){const e=R(!1),t=W();return t&&T(()=>{e.value=!0},t),e}function te(e){const t=ee();return M(()=>(t.value,!!e()))}function oe(e,t,n={}){const{root:c,rootMargin:p="0px",threshold:m=0,window:v=Z,immediate:o=!0}=n,r=te(()=>v&&"IntersectionObserver"in v),a=M(()=>{const g=F(e);return Y(g).map(y).filter(X)});let u=w;const l=f(o),x=r.value?O(()=>[a.value,y(c),l.value],([g,A])=>{if(u(),!l.value||!g.length)return;const k=new IntersectionObserver(t,{root:y(A),rootMargin:p,threshold:m});g.forEach(C=>C&&k.observe(C)),u=()=>{k.disconnect(),u=w}},{immediate:o,flush:"post"}):w,_=()=>{u(),x(),l.value=!1};return K(_),{isSupported:r,isActive:l,pause(){u(),l.value=!1},resume(){l.value=!0},stop:_}}const ae={style:{width:"100%"},class:"d-flex justify-start"},ie={__name:"index",setup(e){const t=f([]),n=f(1),c=f(!0),p=f(null);T(async()=>{await m(),v()});const m=async()=>{try{console.log("開始取得食譜資料...");const o=await fetch(`http://localhost:4000/recipeAPI/getPasta?page=${n.value}`);console.log("取得食譜資料成功!");const r=await o.json();console.log("前端收到的資料:",r),r.result.length>0?(t.value=[...t.value,...r.result.map(a=>({...a,isFavorite:!1}))],n.value+=1):c.value=!1}catch(o){console.error("取得食譜資料失敗:",o)}},v=()=>{oe(p,([{isIntersecting:o}])=>{o&&c.value&&m()},{threshold:.5})};return(o,r)=>(d(),h(J,null,{default:s(()=>[i(H,null,{default:s(()=>[j("div",ae,[i(V,{cols:"6"},{default:s(()=>[i(E,{modelValue:o.search,"onUpdate:modelValue":r[0]||(r[0]=a=>o.search=a),"prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"])]),_:1})]),(d(!0),D(P,null,$(t.value,(a,u)=>(d(),h(V,{key:a.id,cols:"3"},{default:s(()=>[i(G,null,{default:s(()=>[i(q,{src:a.image,class:"image",cover:""},{default:s(()=>[o.isFavorite?S("",!0):(d(),h(L,{key:0,class:"add-favorite-icon",onClick:l=>o.toggleFavorite(a)},{default:s(()=>[b(I(a.isFavorite?"mdi-heart":"mdi-heart-plus-outline"),1)]),_:2},1032,["onClick"]))]),_:2},1032,["src"]),i(U,null,{default:s(()=>[b(I(a.title),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),c.value?(d(),h(V,{key:0,ref_key:"loadMoreTrigger",ref:p,cols:"12"},{default:s(()=>[i(z,{indeterminate:"",color:"primary"})]),_:1},512)):S("",!0)]),_:1})]),_:1}))}};export{ie as default};
