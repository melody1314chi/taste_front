import{u as k,a as x,W as q,h as w,a5 as I,a4 as $,g as B,w as r,bG as F,o as N,d as e,S as l,T as u,ai as P,ax as Q,e as n,ar as T,Z as M,_ as R,bk as U}from"./index-CdXrf5kD.js";import{c as A,d as D,u as E,e as O}from"./index.esm-CGHwd_I-.js";import{b as y}from"./route-block-B_A1xBdJ.js";import{V as j}from"./VContainer-CBe7NjUn.js";import{V as G}from"./VRow-Dxr6VA6r.js";import{V as p}from"./VCol-BRjPifxR.js";import{V as L}from"./VDivider-DPAZxzmH.js";import{V as W}from"./VForm-XDcUWyEx.js";const Z={class:"text-center"},z={class:"text-center"},H={__name:"[id]",setup(J){const{api:V,apiAuth:b}=$(),_=F(),m=I(),{t:s}=k(),f=x(),g=q(),t=w({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:"food"});(async()=>{try{const{data:a}=await V.get("/product/"+_.params.id);t.value=a.result,document.title=t.value.name+" | Taste of Us"}catch(a){console.log(a),m.push("/")}})();const h=A({quantity:D().typeError(s("product.addCartQuantityInvalid")).required(s("product.addCartQuantityInvalid")).positive(s("product.addCartQuantityInvalid")).integer(s("product.addCartQuantityInvalid"))}),{handleSubmit:S,isSubmitting:v}=E({validationSchema:h,initialValues:{quantity:1}}),d=O("quantity"),C=S(async a=>{var i,c;if(!f.isLoggedIn){m.push("/login");return}try{const{data:o}=await b.patch("/user/cart",{product:t.value._id,quantity:a.quantity});f.cart=o.result,g({text:s("product.addCartSuccess"),snackbarProps:{color:"green"}})}catch(o){console.log(o),g({text:s("api."+(((c=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:c.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(a,i)=>(N(),B(j,null,{default:r(()=>[e(G,null,{default:r(()=>[e(p,{cols:"12"},{default:r(()=>[l("h1",Z,u(t.value.name),1)]),_:1}),e(L),e(p,{cols:"12",md:"6"},{default:r(()=>[e(P,{src:t.value.image},null,8,["src"])]),_:1}),e(p,{cols:"12",md:"6"},{default:r(()=>[l("p",null,u(a.$t("productCategory."+t.value.category)),1),l("p",null,u(t.value.price),1),l("p",null,u(t.value.description),1),e(W,{disabled:n(v),onSubmit:Q(n(C),["prevent"])},{default:r(()=>[e(T,{modelValue:n(d).value.value,"onUpdate:modelValue":i[0]||(i[0]=c=>n(d).value.value=c),modelModifiers:{number:!0},type:"number","error-messages":n(d).errorMessage.value},null,8,["modelValue","error-messages"]),e(M,{type:"submit","prepend-icon":"mdi-cart",loading:n(v)},{default:r(()=>[R(u(a.$t("product.addCart")),1)]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}),e(U,{"model-value":!t.value.sell,class:"align-center justify-center",scrim:"black",opacity:"0.8",persistent:""},{default:r(()=>[l("h1",z,u(a.$t("api.productNotOnSell")),1)]),_:1},8,["model-value"])]),_:1}))}};typeof y=="function"&&y(H);export{H as default};
