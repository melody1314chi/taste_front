import{a as A,W as I,u as L,h as R,c as f,g as _,w as r,a4 as q,a5 as z,o as c,d as a,S as k,T as l,b as V,F as h,r as D,R as E,_ as v,Z as u,aB as F,ai as T}from"./index-DpGVHu_m.js";import{b as g}from"./route-block-B_A1xBdJ.js";import{V as P}from"./VContainer-BkSpNhML.js";import{V as U}from"./VRow-z9MLI__U.js";import{V as i}from"./VCol-CkO_qeVS.js";import{V as y}from"./VDivider-Cb5NaCeE.js";import{V as W,a as Z}from"./VList-CQIbQClo.js";const j={class:"text-center"},G={__name:"cart",setup(H){const{apiAuth:n}=q(),d=A(),C=z(),b=I(),{t:w}=L(),o=R([]),p=async()=>{try{const{data:e}=await n.get("/user/cart");o.value=e.result}catch(e){console.log(e)}};p();const x=f(()=>o.value.reduce((e,s)=>e+s.product.price*s.quantity,0)),B=f(()=>o.value.length>0&&o.value.every(e=>e.product.sell)),m=async(e,s)=>{try{const{data:t}=await n.patch("/user/cart",{product:e,quantity:s});d.cart=t.result,p()}catch(t){console.log(t)}},N=async()=>{var e,s;try{await n.post("/order"),d.cart=0,C.push("/orders")}catch(t){console.log(t),b({text:w("api."+(((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(e,s)=>(c(),_(P,null,{default:r(()=>[a(U,null,{default:r(()=>[a(i,{cols:"12"},{default:r(()=>[k("h1",j,l(e.$t("nav.cart")),1)]),_:1}),a(y),a(i,{cols:"12"},{default:r(()=>[a(W,{lines:"two"},{default:r(()=>[(c(!0),V(h,null,D(o.value,(t,S)=>(c(),V(h,{key:t._id},[a(Z,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-pink-lighten-4",active:!t.product.sell},{prepend:r(()=>[a(F,{rounded:"0"},{default:r(()=>[a(T,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:r(()=>[a(u,{color:"red",icon:"mdi-minus",size:"x-small",class:"mr-4",onClick:$=>m(t.product._id,-1)},null,8,["onClick"]),v(" "+l(t.quantity)+" ",1),a(u,{color:"green",icon:"mdi-plus",size:"x-small",class:"ml-4",onClick:$=>m(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),S<o.value.length-1?(c(),_(y,{key:0})):E("",!0)],64))),128))]),_:1})]),_:1}),a(i,{cols:"12",class:"text-center"},{default:r(()=>[k("p",null,l(x.value),1),a(u,{color:"red",disabled:!B.value,onClick:N},{default:r(()=>[v(l(e.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof g=="function"&&g(G);export{G as default};
